<!DOCTYPE html>
<html>
<body style="align-items: center; text-align: center">
    
    <h2>Internship Tracking System</h2>

    <h3>Add Internship</h3>
    <form id="internshipForm">
        <input type="text" id="studentId" placeholder="Student ID" required><br><br>
        <input type="text" id="name" placeholder="Name" required><br><br>
        <input type="text" id="company" placeholder="Company" required><br><br>
        <input type="text" id="duration" placeholder="Duration (e.g., 3 months)" required><br><br>
        <button type="submit">Submit</button>
    </form>

    <br>

    <h3>Mark Internship as Completed</h3>
    <form id="updateForm">
        <input type="text" id="updateStudentId" placeholder="Student ID" required><br><br>
        <button type="submit">Mark as Completed</button>
    </form>

    <br>

    <button id="show-infosys">Show Infosys Interns</button>
    <button id="show-all">Show All Interns</button>

    <script>
        // ADD INTERNSHIP
        document.getElementById("internshipForm").addEventListener("submit", async (e) => {
            e.preventDefault();

            const data = {
                studentId: document.getElementById("studentId").value,
                name: document.getElementById("name").value,
                company: document.getElementById("company").value,
                duration: document.getElementById("duration").value
            };

            const res = await fetch("/internships", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data)
            });

            if (res.ok) {
                alert("Internship saved!");
                document.getElementById("internshipForm").reset();
            } else {
                alert("Error!");
            }
        });

        // MARK INTERNSHIP AS COMPLETED
        document.getElementById("updateForm").addEventListener("submit", async (e) => {
            e.preventDefault();

            const data = {
                studentId: document.getElementById("updateStudentId").value
            };

            const res = await fetch("/internships/complete", {
                method: "PUT",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data)
            });

            if (res.ok) {
                alert(`Internship for ${data.studentId} marked as completed!`);
                document.getElementById("updateForm").reset();
            } else {
                alert("ERROR!");
            }
        });

        // SHOW INFOSYS INTERNS
        document.getElementById("show-infosys").addEventListener("click", async (e) => {
            e.preventDefault();

            const res = await fetch("/internships/infosys", {
                method: "GET",
            });

            if (res.ok) {
                const interns = await res.json();
                console.log("Infosys Interns:", interns);
                console.log(JSON.stringify(interns, null, 2));
                alert(`Found ${interns.length} Infosys interns. Check console for details.`);
            } else {
                alert("Error");
            }
        });

        // SHOW ALL INTERNS
        document.getElementById("show-all").addEventListener("click", async (e) => {
            e.preventDefault();

            const res = await fetch("/internships", {
                method: "GET",
            });

            if (res.ok) {
                const interns = await res.json();
                console.log("All Interns:", interns);
                console.log(JSON.stringify(interns, null, 2));
                alert(`Found ${interns.length} total interns. Check console for details.`);
            } else {
                alert("Error");
            }
        });
    </script>
</body>
</html>
